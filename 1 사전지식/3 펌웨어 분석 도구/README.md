# 3. 펌웨어 분석 도구

펌웨어 추출 후에는 확보한 이미지를 대상으로 정적·동적 분석을 진행해야 한다. 

정적 분석 단계에서는 Binwalk, strings, objdump 등으로 펌웨어 내부 구조와 부팅 과정을 확인하고, Ghidra 또는 IDA Pro로 바이너리 파일을 디스어셈블·디컴파일하여 코드 흐름을 분석한다. 이후 동적 분석 단계에서 이 정보를 바탕으로 QEMU 기반 에뮬레이션을 구성한 뒤, GDBserver, strace, Wireshark, tcpdump 등을 활용하면 런타임 동작을 재현·제어하며 메모리와 네트워크 이벤트를 관찰할 수 있는 환경을 마련할 수 있다. 

본 문서에서는 이러한 펌웨어 분석 과정에 필수적인 도구의 개요와 기본 사용법을 간략히 소개한다. 이를 통해 정적·동적 분석 흐름에 따라 각 도구가 어떻게 활용되는지 안내하고자 한다. 

# 3.1 Binwalk

## 3.1.1 Binwalk 개요

Binwalk는 임베디드 펌웨어와 같은 바이너리 파일에서 파일 시그니처, 압축 스트림, 코드 조각을 식별하고, 해당 조각을 분석 및 추출해주는 오픈소스 분석 도구이다. `-Me` 옵션을 통해 분석 결과를 구조화된 폴더 트리 형태로 확인할 수 있다. 

## 3.1.2 Binwalk 옵션

| 옵션 | 의미·용도 |
| --- | --- |
| `-e, --extract` | 인식된 파일을 추출한다.  |
| `-M, --matryoshka` | 추출된 파일을 재귀적으로 재스캔한다.  |
| `-B, --signature` | 대상 파일에서 일반적인 파일 시그니처를 스캔한다,  |
| `-A, --opcodes` | 실행 파일의 일반적인 opcode 시그니처를 스캔한다. 아키텍처 확인에 사용 가능하다.  |
| `-E, --entropy` | 파일 엔트로피를 계산한다.  |

# 3.2 IDA Pro & Ghidra

## 3.2.1 IDA(**I**nteractive **D**is**A**ssembler) Pro

IDA Pro는 Hex‑Rays사가 개발한 상용 인터랙티브 디스어셈블러이다. 여러 환경에서의 디버깅이 가능하고 그래프‑뷰 기반으로 코드를 탐색할 수 있으며 Hex‑Rays C 디컴파일러를 통해 어셈블리를 고수준 C 유사 코드로 변환해주는 등 다양하고 편리한 기능을 제공한다. 이러한 장점에 힘입어 리버스 엔지니어링, 악성코드 분석, 임베디드 펌웨어 연구 등 다양한 분야에 활용되고 있다.

## 3.2.2 Ghidra

Ghidra는 미국 국가안전보위국(NSA)이 공개한 오픈소스 소프트웨어 리버스 엔지니어링(SRE) 프레임워크로, 디스어셈블러·디컴파일러·디버거·바이너리 비교기를 통합 GUI에 담아 무료로 제공한다. 공식 지원되지 않는 CPU 아키텍처도 연구자가 직접 기술·추가할 수 있으며, 내장 에뮬레이터 및 스크립트 콘솔을 활용해 런타임 행동을 부분적으로 재현하거나 자동 패턴 분석을 수행할 수 있다. 이러한 확장성과 협업성 덕분에 상용 도구가 부담스러운 환경에서도 고급 정적‑동적 분석 환경을 구축할 수 있다는 점이 Ghidra의 가장 큰 장점이다.

# 3.3 QEMU(Quick EMUlator)

## 3.3.1 QEMU 개요

QEMU는 다양한 CPU 아키텍처와 시스템을 소프트웨어로 재현하는 오픈소스 가상화·에뮬레이션 도구이다. 원래 서로 다른 프로세서용 실행 파일을 실행하기 위해 고안됐지만, 지금은 운영체제 부팅, 드라이버 개발, 보안 분석, 자동화 테스트 등 폭넓은 분야에서 활용된다. 명령행(CLI) 기반이라 스크립트 자동화에 적합하며, 특히 리눅스 환경에서 안정적이고 강력하게 작동한다. 하드웨어 없이도 커널·부트로더·루트 파일시스템을 가상으로 손쉽게 검증할 수 있다는 점이 큰 장점이다. 

## 3.3.2 QEMU 옵션

| 옵션 | 의미·용도 |
| --- | --- |
| `-M <machine>` | 에뮬레이션할 보드 모델을 지정한다. |
| `-cpu <model>` | 가상 CPU 마이크로아키텍처를 선택한다. |
| `-m <size>` | 게스트 메모리 크기(MB)를 설정한다. |
| `-kernel <file>` | 자체 빌드한 커널 이미지를 로딩할 때 사용한다. |
| `-append "<cmdline>"` | 게스트 커널에 전달할 커맨드라인을 지정한다.  |
| `-drive file=<img>,format=<fmt>,if=<iface>` | 디스크·플래시 이미지를 가상 장치에 연결한다. |
| `-nographic` | VGA 창을 끄고 직렬 콘솔(ttyS0)을 표준입출력으로 리디렉션한다.  |
| `-gdb tcp::<port>` | QEMU 내부에 GDB 서버를 열고 설정한 TCP 포트에서 대기한다. 게스트가 실행 중인 상태에서 호스트 터미널에서 `gdb vmlinux` → `target remote :<port>` 로 접속하면 라이브 커널·프로세스를 디버깅할 수 있다. |
| `-S` | QEMU CPU를 리셋 직후 정지시킨다. GDB가 연결될 때까지 부팅이 진행되지 않으므로 첫 지점부터 브레이크포인트를 걸 수 있다. |